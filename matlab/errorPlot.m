clc
close all
clear all

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%NGSIM%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%

% % % % % % % % % Baseline   mnor grid alpha change....
% % % % ConstanVelocityAll = [ 0.02051643  0.05702431  0.10729346  0.16951199  0.24279169  0.32663482 ...
% % % %   0.41970393  0.52060387  0.62876306  0.7426886   0.86128211  0.98444438 ...
% % % %   1.11149642  1.24023985  1.3709363   1.50302302  1.63743359  1.77469247 ...
% % % %   1.91457114  2.05759082  2.20431534  2.354738    2.50904885  2.66811237 ...
% % % %   2.83257242  3.0024675   3.17773348  3.35718828  3.54013263  3.72582801 ...
% % % %   3.91342451  4.10277271  4.29409565  4.48705948  4.68139545  4.87699405 ...
% % % %   5.07235279  5.26790284  5.46333581  5.65778454  5.85186499  6.04618423 ...
% % % %   6.24144584  6.43757973  6.63413707  6.83147472  7.02928477  7.22726594 ...
% % % %   7.42539532  7.62384071];
% % % % ConstanVelocity = [ConstanVelocityAll(1), ConstanVelocityAll(10), ConstanVelocityAll(20), ConstanVelocityAll(30), ConstanVelocityAll(40), ConstanVelocityAll(50)];
% % % % t1 = linspace(0,5,length(ConstanVelocity));
% % % % 
% % % % % csLstmAll = [0.1109  0.2170  0.3325  0.4554  0.5806  0.7103  0.8421 ...
% % % % %          0.9774  1.1184  1.2654  1.4191  1.5803  1.7493  1.9259 ...
% % % % %          2.1108  2.3050  2.5094  2.7248  2.9504  3.1874  3.4357 ...
% % % % %          3.6946  3.9643  4.2442  4.5364];
% % % % % csLstm = [csLstmAll(1), csLstmAll(5), csLstmAll(10), csLstmAll(15), csLstmAll(20), csLstmAll(25)];
% % % % % t2 = linspace(0,5,length(csLstm));
% % % % % 
% % % % % dualLstm = [0.1, 0.47 1.39 2.57 4.04 5.77];
% % % % % t3 = linspace(0,5,length(dualLstm));
% % % % % 
% % % % % matf = [0.01 0.66 1.34 2.08 2.97 4.13];
% % % % % t4 = linspace(0,5,length(matf));
% % % % % 
% % % % % scaleNet = [0.01 0.45, 1.15 1.97 2.91];
% % % % % t5 = linspace(0,4,length(scaleNet));  % Sale net 4 sec
% % % % 
% % % % % proposed decoder technique with 4 cars
% % % % proposedCarGTAll = [0.01316021 0.02422175 0.03975447 0.06090639 0.08632742 0.11450247 ....
% % % %  0.14493088 0.17688401 0.21017774 0.24488715 0.28076939 0.31781868 ....
% % % %  0.35617534 0.39581448 0.43686534 0.47932421 0.52347455 0.56923084 ....
% % % %  0.61652496 0.66525313 0.71550764 0.76733198 0.82076258 0.87615473 ....
% % % %  0.93348659 0.99288972 1.05454772 1.11849994 1.18456633 1.25286773 ....
% % % %  1.32315423 1.39537846 1.46947937 1.54550556 1.62348976 1.70355022 ....
% % % %  1.78575645 1.87002677 1.95621059 2.04383851 2.13306976 2.22382764 ....
% % % %  2.31646902 2.41109612 2.50783518 2.60659319 2.7073165  2.80980064 ....
% % % %  2.91422325 3.02038039];
% % % % proposedCarGT = [proposedCarGTAll(1), proposedCarGTAll(10), proposedCarGTAll(20), proposedCarGTAll(30), proposedCarGTAll(40), proposedCarGTAll(50)];
% % % % t6 = linspace(0,5,length(proposedCarGT));
% % % % GTVarAll = [0.07080254 0.10350391 0.16064069 0.23142138 0.30827448 0.38621459 ...
% % % %  0.46366453 0.54089114 0.6179977  0.69538553 0.7733814  0.85228183 ...
% % % %  0.93250466 1.01433603 1.09760597 1.18242123 1.26852075 1.35610616 ...
% % % %  1.44545509 1.53696911 1.63094011 1.72749695 1.82680726 1.92867517 ...
% % % %  2.03287573 2.13918658 2.24764665 2.35833177 2.47132706 2.58672278 ...
% % % %  2.7044242  2.82440984 2.94681531 3.07185142 3.1996935  3.33037543 ...
% % % %  3.46394095 3.6003833  3.73959666 3.88150835 4.02622061 4.17369038 ...
% % % %  4.32384032 4.47647368 4.63157155 4.78900882 4.94879627 5.11090956 ...
% % % %  5.27538127 5.44218423];
% % % % GTVar = [GTVarAll(1), GTVarAll(10), GTVarAll(20), GTVarAll(30), GTVarAll(40), GTVarAll(50)];
% % % % 
% % % % % Proposed Re train technique
% % % % RetrainTechniqueAll = [0.03503073 0.05411147 0.08199093 0.11851545 0.16093491 0.20657636 ...
% % % %  0.25491516 0.30504614 0.35688302 0.41037929 0.4652293  0.52131188 ...
% % % %  0.57877879 0.63759146 0.69793733 0.75977066 0.8233635  0.88887702 ...
% % % %  0.95616749 1.02525422 1.09624232 1.1690881  1.24401659 1.32139784 ...
% % % %  1.40107601 1.48309661 1.56754916 1.65450146 1.74387579 1.83589066 ...
% % % %  1.93034246 2.02718703 2.12627991 2.22759823 2.33109589 2.43669109 ...
% % % %  2.54461051 2.65483757 2.76736959 2.88158603 2.99740171 3.11529916 ...
% % % %  3.23522196 3.35732964 3.48155487 3.60798436 3.73656097 3.86705657 ...
% % % %  3.99978533 4.13483206];
% % % % RetrainTechnique = [RetrainTechniqueAll(1), RetrainTechniqueAll(10), RetrainTechniqueAll(20), RetrainTechniqueAll(30), RetrainTechniqueAll(40), RetrainTechniqueAll(50)];
% % % % t7 = linspace(0,5,length(RetrainTechnique));
% % % % 
% % % % % Proposed V-LSTM
% % % % vLstmAll = [0.03413486 0.07322096 0.11583078 0.16219678 0.21329516 0.26956154 ...
% % % %  0.33055762 0.39532328 0.46318081 0.53438828 0.6092031  0.68772506 ...
% % % %  0.76951975 0.85437748 0.94246712 1.03364818 1.12796621 1.22520973 ...
% % % %  1.32550522 1.42868081 1.53465867 1.64329033 1.75485308 1.86907634 ...
% % % %  1.98614524 2.10585897 2.22832804 2.35351979 2.48157407 2.61248531 ...
% % % %  2.74628193 2.88299798 3.02263167 3.16495367 3.31018793 3.45862213 ...
% % % %  3.61007502 3.76449502 3.92174853 4.08176088 4.24459931 4.4105704 ...
% % % %  4.57962115 4.75158534 4.92624982 5.10339751 5.28277326 5.4645479 ...
% % % %  5.64870521 5.83559159];
% % % % vLstm = [vLstmAll(1), vLstmAll(10), vLstmAll(20), vLstmAll(30), vLstmAll(40), vLstmAll(50)];
% % % % t8 = linspace(0,5,length(vLstm));
% % % % 
% % % % 
% % % % 
% % % % 
% % % % % plots
% % % % plot(t1,ConstanVelocity, '-*', 'LineWidth',2, 'MarkerSize',12)
% % % % hold on
% % % % plot(t8,vLstm, '-h', 'LineWidth',2, 'MarkerSize',12)
% % % % hold on
% % % % % plot(t3,dualLstm, '-d', 'LineWidth',2, 'MarkerSize',12)
% % % % % hold on
% % % % % plot(t2,csLstm, '-o', 'LineWidth',2, 'MarkerSize',12)
% % % % % hold on
% % % % % plot(t4,matf, '-+', 'LineWidth',2, 'MarkerSize',12)
% % % % % hold on
% % % % % plot(t5,scaleNet, '-p', 'LineWidth',2, 'MarkerSize',12)
% % % % % hold on
% % % % plot(t6,proposedCarGT, '-x', 'LineWidth',2, 'MarkerSize',12)
% % % % hold on
% % % % plot(t7,RetrainTechnique, '-s', 'LineWidth',2, 'MarkerSize',12)
% % % % hold on
% % % % 
% % % % % Plot params
% % % % xlabel('Time (Sec)', 'FontSize', 15);
% % % % ylabel('RMS Error (m)', 'FontSize', 15);
% % % % lgd = legend('CV', 'V-LSTM', 'Proposed (GT-surrounding)','Proposed (retrain technique)');
% % % % lgd.FontSize = 13;
% % % % a = get(gca,'XTickLabel');  
% % % % set(gca,'XTickLabel',a,'fontsize',15)
% % % % a = get(gca,'YTickLabel');  
% % % % set(gca,'YTickLabel',a,'fontsize',15)
% % % % grid on
% % % % ax=gca;
% % % % ax.GridAlpha=0.95;
% % % % grid minor
% % % % ax=gca;
% % % % ax.GridAlpha=0.95;



%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%Radiate%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Sighthill.
sighthillAll = [0.71539388 1.2867068  1.06759797 1.25651194 1.26128427 1.37779653 ...
 1.40906187 1.7604538  1.77556281 2.06707725 2.27156388 2.33042668 ...
 2.46844399 2.8296784  2.85016934 3.13818912 3.30941444 3.45851871 ...
 3.72502597 3.78928181];
sighthill = [sighthillAll(1), sighthillAll(4), sighthillAll(8), sighthillAll(12), sighthillAll(16), sighthillAll(20)];
t1 = linspace(0,5,length(sighthill));

sightHillMotionAll = [0.4459364  0.69116358 0.90175739 1.09312367 1.33098176 1.5789376 ...
 1.85857469 2.11132394 2.38282535 2.72493628 2.96876515 3.22941633 ...
 3.49565476 3.80554655 4.15239564 4.43438856 4.70523368 5.03694681 ...
 5.39242995 5.78385167];
sightMotion = [sightHillMotionAll(1), sightHillMotionAll(4), sightHillMotionAll(8), sightHillMotionAll(12),sightHillMotionAll(16), sightHillMotionAll(20)];
t2 = linspace(0,5,length(sightMotion));


% sighthill = [sighthillAll(1), sighthillAll(5), sighthillAll(10), sighthillAll(15), sighthillAll(20)];

% Alvie
alvieAll = [0.63590689 0.82926423 0.98639497 1.11480832 1.26538898 1.37431586 ...
 1.50461706 1.62865655 1.74560937 1.88921424 2.02514033 2.1723246 ...
 2.32731355 2.48596048 2.64021877 2.78681347 2.97936053 3.17419329 ...
 3.39016639 3.60828052];
alvie = [alvieAll(1), alvieAll(4), alvieAll(8), alvieAll(12), alvieAll(16),alvieAll(20)];
t3 = linspace(0,5,length(alvie));


alvieMotionAll = [0.27110479 0.46120062 0.60322585 0.70494223 0.8157737  0.94246364 ...
 1.0824368  1.23651102 1.3871897  1.54429242 1.69975439 1.85880843 ...
 2.02323768 2.18820248 2.345219   2.49854329 2.65713221 2.81576805 ...
 2.98378932 3.15018988];
alvieMo = [alvieMotionAll(1), alvieMotionAll(4), alvieMotionAll(8), alvieMotionAll(12), alvieMotionAll(16), alvieMotionAll(20)];
t4 = linspace(0,5,length(alvieMo));


% proposed decoder technique with 4 cars
proposedCarGTAll = [0.01316021 0.02422175 0.03975447 0.06090639 0.08632742 0.11450247 ....
 0.14493088 0.17688401 0.21017774 0.24488715 0.28076939 0.31781868 ....
 0.35617534 0.39581448 0.43686534 0.47932421 0.52347455 0.56923084 ....
 0.61652496 0.66525313 0.71550764 0.76733198 0.82076258 0.87615473 ....
 0.93348659 0.99288972 1.05454772 1.11849994 1.18456633 1.25286773 ....
 1.32315423 1.39537846 1.46947937 1.54550556 1.62348976 1.70355022 ....
 1.78575645 1.87002677 1.95621059 2.04383851 2.13306976 2.22382764 ....
 2.31646902 2.41109612 2.50783518 2.60659319 2.7073165  2.80980064 ....
 2.91422325 3.02038039];
proposedCarGT = [proposedCarGTAll(3), proposedCarGTAll(10), proposedCarGTAll(20), proposedCarGTAll(30), proposedCarGTAll(40), proposedCarGTAll(50)];
t5 = linspace(0,5,length(proposedCarGT));


% plots
plot(t1,sighthill, '-*', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t2,sightMotion, '-s', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t3,alvie, '-o', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t4,alvieMo, '-p', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t5,proposedCarGT, '-d', 'LineWidth',2, 'MarkerSize',12)
hold on

% Plot params
xlabel('Time (Sec)', 'FontSize', 15);
ylabel('RMS Error (m)', 'FontSize', 15);
legend('Edinburgh_{pos} (Radiate)', 'Edinburgh_{v} (Radiate)','Kingussie_{pos} (Radiate)', 'Kingussie_{v} (Radiate)', 'Lankershim (NGSIM)')
a = get(gca,'XTickLabel');  
set(gca,'XTickLabel',a,'fontsize',15)
a = get(gca,'YTickLabel');  
set(gca,'YTickLabel',a,'fontsize',15)
grid on
ax=gca;
ax.GridAlpha=0.95;
grid minor
ax=gca;
ax.GridAlpha=0.95;
