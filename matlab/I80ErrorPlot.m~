clc
close all
clear all

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%NGSIM%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%

% % Baseline   mnor grid alpha change....
ConstanVelocityAll = [0.05545523 0.11526354 0.17889499 0.24600828 0.31635767 0.39015268 ...
 0.46744671 0.54799093 0.63173239 0.71862335 0.8087071  0.90196883 ...
 0.99828287 1.09758468 1.19993298 1.30530953 1.41344468 1.5244343 ...
 1.63823483 1.75466262 1.87366602 1.9954217  2.11966285 2.2464785 ...
 2.37611049 2.50860994 2.64411667 2.78253973 2.92371543 3.06746073 ...
 3.21402985 3.36345995 3.51568458 3.67077318 3.82876511 3.98954288 ...
 4.15324582 4.31977176 4.48911959 4.66125524 4.83598175 5.01304298 ...
 5.19237554 5.3740086  5.55819875 5.74527994 5.93523922 6.12816775 ...
 6.32402177 6.52271456];
ConstanVelocity = [ConstanVelocityAll(1), ConstanVelocityAll(10), ConstanVelocityAll(20), ConstanVelocityAll(30), ConstanVelocityAll(40), ConstanVelocityAll(50)];
t1 = linspace(0,5,length(ConstanVelocity));

csLstmAll = [0.1109  0.2170  0.3325  0.4554  0.5806  0.7103  0.8421 ...
         0.9774  1.1184  1.2654  1.4191  1.5803  1.7493  1.9259 ...
         2.1108  2.3050  2.5094  2.7248  2.9504  3.1874  3.4357 ...
         3.6946  3.9643  4.2442  4.5364];
csLstm = [csLstmAll(1), csLstmAll(5), csLstmAll(10), csLstmAll(15), csLstmAll(20), csLstmAll(25)];
t2 = linspace(0,5,length(csLstm));

dualLstm = [0.1, 0.47 1.39 2.57 4.04 5.77];
t3 = linspace(0,5,length(dualLstm));

matf = [0.01 0.66 1.34 2.08 2.97 4.13];
t4 = linspace(0,5,length(matf));

scaleNet = [0.01 0.45, 1.15 1.97 2.91];
t5 = linspace(0,4,length(scaleNet));  % Sale net 4 sec

% proposed decoder technique with 4 cars
proposedCarGTAll = [0.01283851 0.02375541 0.03903992 0.05986511 0.08490808 0.11267175 ...
 0.14267319 0.17416778 0.20702027 0.24127269 0.2766941  0.31324362 ...
 0.35107598 0.39017269 0.43064308 0.47258124 0.51617178 0.56137639 ...
 0.60810895 0.65628693 0.70599091 0.75727249 0.8101217  0.86495683 ...
 0.92170132 0.98048811 1.04151819 1.10484894 1.17030776 1.23798281 ...
 1.30762179 1.37921609 1.45265931 1.52797222 1.60518453 1.68442961 ...
 1.765802   1.84922042 1.93454255 2.02135428 2.1098109  2.19980695 ...
 2.29170977 2.38557715 2.48158419 2.57959364 2.67959063 2.78132859 ...
 2.88496248 2.99030481];
proposedCarGT = [proposedCarGTAll(1), proposedCarGTAll(10), proposedCarGTAll(20), proposedCarGTAll(30), proposedCarGTAll(40), proposedCarGTAll(50)];
t6 = linspace(0,5,length(proposedCarGT));
% 
% GTVarAll = [0.07080254 0.10350391 0.16064069 0.23142138 0.30827448 0.38621459 ...
%  0.46366453 0.54089114 0.6179977  0.69538553 0.7733814  0.85228183 ...
%  0.93250466 1.01433603 1.09760597 1.18242123 1.26852075 1.35610616 ...
%  1.44545509 1.53696911 1.63094011 1.72749695 1.82680726 1.92867517 ...
%  2.03287573 2.13918658 2.24764665 2.35833177 2.47132706 2.58672278 ...
%  2.7044242  2.82440984 2.94681531 3.07185142 3.1996935  3.33037543 ...
%  3.46394095 3.6003833  3.73959666 3.88150835 4.02622061 4.17369038 ...
%  4.32384032 4.47647368 4.63157155 4.78900882 4.94879627 5.11090956 ...
%  5.27538127 5.44218423];
% GTVar = [GTVarAll(1), GTVarAll(10), GTVarAll(20), GTVarAll(30), GTVarAll(40), GTVarAll(50)];

% Proposed Re train technique
RetrainTechniqueAll = [0.03330345 0.05182776 0.07880674 0.11432685 0.1557817  0.2005489 ...
 0.24807774 0.29736123 0.34838416 0.40108009 0.45512033 0.51034057 ...
 0.56691778 0.62484468 0.68431748 0.74529235 0.80800452 0.8725917 ...
 0.93893949 1.00706469 1.07707805 1.14899121 1.22299592 1.2994176 ...
 1.37806849 1.45906299 1.5424765  1.62837527 1.71668371 1.80759989 ...
 1.90092292 1.99658872 2.09451173 2.19462758 2.29696307 2.40133911 ...
 2.50802925 2.61696323 2.72817855 2.84101538 2.95544994 3.07197582 ...
 3.19051332 3.31121225 3.43400856 3.55899172 3.68611576 3.8151469 ...
 3.94629983 4.0796887 ];
RetrainTechnique = [RetrainTechniqueAll(1), RetrainTechniqueAll(10), RetrainTechniqueAll(20), RetrainTechniqueAll(30), RetrainTechniqueAll(40), RetrainTechniqueAll(50)];
t7 = linspace(0,5,length(RetrainTechnique));

% Proposed V-LSTM
vLstmAll = [0.0142791  0.03879691 0.07060301 0.10728738 0.14765549 0.19239041 ...
 0.24255448 0.29819035 0.35835699 0.42219114 0.48924314 0.55975809 ...
 0.63388359 0.7116392  0.79274546 0.87697161 0.96451318 1.05503207 ...
 1.14855807 1.24505603 1.34455545 1.44693786 1.5521495  1.66010648 ...
 1.77090479 1.88447843 2.00080803 2.1198801  2.2417079  2.3663086 ...
 2.49371177 2.62406135 2.75733014 2.89358182 3.03275477 3.17465655 ...
 3.31944391 3.46746713 3.61849647 3.77257748 3.92956701 4.0893339 ...
 4.25195072 4.41776097 4.58672266 4.75867126 4.93331706 5.1104837 ...
 5.28986106 5.47145528];
vLstm = [vLstmAll(1), vLstmAll(10), vLstmAll(20), vLstmAll(30), vLstmAll(40), vLstmAll(50)];
t8 = linspace(0,5,length(vLstm));

OGMTechniqueAll =  [ 0.11621812  0.18394079  0.21672137  0.29555489  0.35061835  0.44089435 ...
  0.51128353  0.61882231  0.70468071  0.80905517  0.89316197  1.00572175 ...
  1.08185067  1.18275244  1.25199655  1.34541796  1.41951536  1.51538614 ...
  1.58276513  1.67659345  1.74422827  1.83856617  1.9048399   1.99278115 ...
  2.05121459  2.13536046  2.19085227  2.27460417  2.32536398  2.39708152 ...
  2.46312847  2.52840413  2.5906387   2.66298736  2.73056248  2.83132609 ...
  2.91732234  3.03390301  3.1251496   3.23314238  3.32494943  3.43773432 ...
  3.54573257  3.6811707   3.81085155  3.9488701   4.08754876  4.2317728 ...
  4.36444433  4.50467];
OGMTechnique = [OGMTechniqueAll(1), OGMTechniqueAll(10), OGMTechniqueAll(20), OGMTechniqueAll(30), OGMTechniqueAll(40), OGMTechniqueAll(50)];
t9 = linspace(0,5,length(vLstm));



% plots
plot(t1,ConstanVelocity, '-*', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t8,vLstm, '-h', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t3,dualLstm, '-d', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t2,csLstm, '-o', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t4,matf, '-+', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t5,scaleNet, '-p', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t6,proposedCarGT, '-x', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t7,RetrainTechnique, '-s', 'LineWidth',2, 'MarkerSize',12)
hold on
plot(t9,OGMTechnique, '-s', 'LineWidth',2, 'MarkerSize',12)
hold on

% Plot params
xlabel('Time (Sec)', 'FontSize', 15);
ylabel('RMS Error (m)', 'FontSize', 15);
lgd = legend('CV', 'V-LSTM', 'Dual-LSTM [32]', 'CS-LSTM [33]', 'MATF [62]','SCALE-Net [63]', 'Proposed (GT-surrounding)', 'Proposed (retrain technique)');
lgd.FontSize = 13;
a = get(gca,'XTickLabel');  
set(gca,'XTickLabel',a,'fontsize',15)
a = get(gca,'YTickLabel');  
set(gca,'YTickLabel',a,'fontsize',15)
grid on
ax=gca;
ax.GridAlpha=0.95;
grid minor
ax=gca;
ax.GridAlpha=0.95;



%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% %%%%%%%Radiate%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%

% % Sighthill.
% sighthillAll = [0.71539388 1.2867068  1.06759797 1.25651194 1.26128427 1.37779653 ...
%  1.40906187 1.7604538  1.77556281 2.06707725 2.27156388 2.33042668 ...
%  2.46844399 2.8296784  2.85016934 3.13818912 3.30941444 3.45851871 ...
%  3.72502597 3.78928181];
% sighthill = [sighthillAll(1), sighthillAll(4), sighthillAll(8), sighthillAll(12), sighthillAll(16), sighthillAll(20)];
% t1 = linspace(0,5,length(sighthill));
% 
% sightHillMotionAll = [0.4459364  0.69116358 0.90175739 1.09312367 1.33098176 1.5789376 ...
%  1.85857469 2.11132394 2.38282535 2.72493628 2.96876515 3.22941633 ...
%  3.49565476 3.80554655 4.15239564 4.43438856 4.70523368 5.03694681 ...
%  5.39242995 5.78385167];
% sightMotion = [sightHillMotionAll(1), sightHillMotionAll(4), sightHillMotionAll(8), sightHillMotionAll(12),sightHillMotionAll(16), sightHillMotionAll(20)];
% t2 = linspace(0,5,length(sightMotion));
% 
% 
% % sighthill = [sighthillAll(1), sighthillAll(5), sighthillAll(10), sighthillAll(15), sighthillAll(20)];
% 
% % Alvie
% alvieAll = [0.63590689 0.82926423 0.98639497 1.11480832 1.26538898 1.37431586 ...
%  1.50461706 1.62865655 1.74560937 1.88921424 2.02514033 2.1723246 ...
%  2.32731355 2.48596048 2.64021877 2.78681347 2.97936053 3.17419329 ...
%  3.39016639 3.60828052];
% alvie = [alvieAll(1), alvieAll(4), alvieAll(8), alvieAll(12), alvieAll(16),alvieAll(20)];
% t3 = linspace(0,5,length(alvie));
% 
% 
% alvieMotionAll = [0.27110479 0.46120062 0.60322585 0.70494223 0.8157737  0.94246364 ...
%  1.0824368  1.23651102 1.3871897  1.54429242 1.69975439 1.85880843 ...
%  2.02323768 2.18820248 2.345219   2.49854329 2.65713221 2.81576805 ...
%  2.98378932 3.15018988];
% alvieMo = [alvieMotionAll(1), alvieMotionAll(4), alvieMotionAll(8), alvieMotionAll(12), alvieMotionAll(16), alvieMotionAll(20)];
% t4 = linspace(0,5,length(alvieMo));
% 
% 
% % proposed decoder technique with 4 cars
% proposedCarGTAll = [0.01316021 0.02422175 0.03975447 0.06090639 0.08632742 0.11450247 ....
%  0.14493088 0.17688401 0.21017774 0.24488715 0.28076939 0.31781868 ....
%  0.35617534 0.39581448 0.43686534 0.47932421 0.52347455 0.56923084 ....
%  0.61652496 0.66525313 0.71550764 0.76733198 0.82076258 0.87615473 ....
%  0.93348659 0.99288972 1.05454772 1.11849994 1.18456633 1.25286773 ....
%  1.32315423 1.39537846 1.46947937 1.54550556 1.62348976 1.70355022 ....
%  1.78575645 1.87002677 1.95621059 2.04383851 2.13306976 2.22382764 ....
%  2.31646902 2.41109612 2.50783518 2.60659319 2.7073165  2.80980064 ....
%  2.91422325 3.02038039];
% proposedCarGT = [proposedCarGTAll(3), proposedCarGTAll(10), proposedCarGTAll(20), proposedCarGTAll(30), proposedCarGTAll(40), proposedCarGTAll(50)];
% t5 = linspace(0,5,length(proposedCarGT));
% 
% 
% % plots
% plot(t1,sighthill, '-*', 'LineWidth',2, 'MarkerSize',12)
% hold on
% plot(t2,sightMotion, '-s', 'LineWidth',2, 'MarkerSize',12)
% hold on
% plot(t3,alvie, '-o', 'LineWidth',2, 'MarkerSize',12)
% hold on
% plot(t4,alvieMo, '-p', 'LineWidth',2, 'MarkerSize',12)
% hold on
% plot(t5,proposedCarGT, '-d', 'LineWidth',2, 'MarkerSize',12)
% hold on
% 
% % Plot params
% xlabel('Time (Sec)', 'FontSize', 15);
% ylabel('RMS Error (m)', 'FontSize', 15);
% legend('Fourway_{pos} (Radiate)', 'Fourway_{v} (Radiate)','T-junction_{pos} (Radiate)', 'T-junction_{v} (Radiate)', 'Lankershim (NGSIM)')
% a = get(gca,'XTickLabel');  
% set(gca,'XTickLabel',a,'fontsize',15)
% a = get(gca,'YTickLabel');  
% set(gca,'YTickLabel',a,'fontsize',15)
% grid on
% ax=gca;
% ax.GridAlpha=0.95;
% grid minor
% ax=gca;
% ax.GridAlpha=0.95;
